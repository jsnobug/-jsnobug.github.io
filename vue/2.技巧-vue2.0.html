<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zfy Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.709c38ce.css" as="style"><link rel="preload" href="/assets/js/app.e2f3dc93.js" as="script"><link rel="preload" href="/assets/js/2.a230187c.js" as="script"><link rel="preload" href="/assets/js/29.8970969c.js" as="script"><link rel="prefetch" href="/assets/js/10.2312baa9.js"><link rel="prefetch" href="/assets/js/11.d799b3b2.js"><link rel="prefetch" href="/assets/js/12.564b17e5.js"><link rel="prefetch" href="/assets/js/13.1eec9129.js"><link rel="prefetch" href="/assets/js/14.3df3ec8e.js"><link rel="prefetch" href="/assets/js/15.64305679.js"><link rel="prefetch" href="/assets/js/16.a30aa559.js"><link rel="prefetch" href="/assets/js/17.af459403.js"><link rel="prefetch" href="/assets/js/18.709ee1da.js"><link rel="prefetch" href="/assets/js/19.fc2f438b.js"><link rel="prefetch" href="/assets/js/20.7690c4c8.js"><link rel="prefetch" href="/assets/js/21.9d692286.js"><link rel="prefetch" href="/assets/js/22.7f35607c.js"><link rel="prefetch" href="/assets/js/23.928f19db.js"><link rel="prefetch" href="/assets/js/24.21ff9813.js"><link rel="prefetch" href="/assets/js/25.5dd3c14d.js"><link rel="prefetch" href="/assets/js/26.8f012fca.js"><link rel="prefetch" href="/assets/js/27.96b38813.js"><link rel="prefetch" href="/assets/js/28.db14b2a0.js"><link rel="prefetch" href="/assets/js/3.8cfec8db.js"><link rel="prefetch" href="/assets/js/30.dbd79d96.js"><link rel="prefetch" href="/assets/js/31.351146bb.js"><link rel="prefetch" href="/assets/js/32.1670f910.js"><link rel="prefetch" href="/assets/js/33.36a8eca8.js"><link rel="prefetch" href="/assets/js/34.e77266ad.js"><link rel="prefetch" href="/assets/js/4.24c3d784.js"><link rel="prefetch" href="/assets/js/5.9368cb62.js"><link rel="prefetch" href="/assets/js/6.04dd46ed.js"><link rel="prefetch" href="/assets/js/7.904b6957.js"><link rel="prefetch" href="/assets/js/8.2e2c89f5.js"><link rel="prefetch" href="/assets/js/9.06bb6d35.js">
    <link rel="stylesheet" href="/assets/css/0.styles.709c38ce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Zfy Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web" class="mobile-dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li></ul></div></div><div class="nav-item"><a href="/webComponents/" class="nav-link">
  组件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用网站" class="dropdown-title"><span class="title">常用网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="常用网站" class="mobile-dropdown-title"><span class="title">常用网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xiao_zheng_123" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jsnobug" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web" class="mobile-dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li></ul></div></div><div class="nav-item"><a href="/webComponents/" class="nav-link">
  组件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用网站" class="dropdown-title"><span class="title">常用网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="常用网站" class="mobile-dropdown-title"><span class="title">常用网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xiao_zheng_123" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jsnobug" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue2.0</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/1.风格-vue2.0.html" class="sidebar-link">风格指南</a></li><li><a href="/vue/2.技巧-vue2.0.html" class="active sidebar-link">/vue/2.技巧-vue2.0.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#⭐⭐⭐vue通讯方式" class="sidebar-link">⭐⭐⭐vue通讯方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_1-parent-children-refs-父子组件" class="sidebar-link">1.$parent,$children,$refs——父子组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_2-props和-emit-父子组件" class="sidebar-link">2.props和$emit ——父子组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_3-sync和v-model语法糖-父子组件" class="sidebar-link">3..sync和v-model语法糖——父子组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_4-v-bind-props-v-bind-attrs-v-on-listener" class="sidebar-link">4.v-bind=$props v-bind=$attrs v-on=$listener</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_5-eventbus-跨组件" class="sidebar-link">5.eventBus——跨组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_6-vuex-跨组件" class="sidebar-link">6.vuex ——跨组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_7-solt作用域插槽-父子组件" class="sidebar-link">7.solt作用域插槽——父子组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_8-provide、inject-父子孙组件" class="sidebar-link">8.provide、inject——父子孙组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_9-dispatch、broadcast-父子孙组件" class="sidebar-link">9.dispatch、broadcast——父子孙组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_10、findcomponents方法-找到任意组件实例" class="sidebar-link">10、findComponents方法（找到任意组件实例）</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#⭐⭐⭐minxins-组件内容的复用" class="sidebar-link">⭐⭐⭐minxins——组件内容的复用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#全局混入" class="sidebar-link">全局混入</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#⭐⭐⭐vue-use" class="sidebar-link">⭐⭐⭐Vue.use</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#vue-prototype-xx" class="sidebar-link">Vue.prototype.$xx</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#vue组件使用方式" class="sidebar-link">vue组件使用方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#普通组件" class="sidebar-link">普通组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#全局组件-component" class="sidebar-link">全局组件-component</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#全局组件-插件" class="sidebar-link">全局组件-插件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#构造组件" class="sidebar-link">构造组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#二次封装组件" class="sidebar-link">二次封装组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#比如二次封装el-dialog" class="sidebar-link">比如二次封装el-dialog</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#require-context-前端工程自动化" class="sidebar-link">require.context——前端工程自动化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#可能会用到require-context的场景" class="sidebar-link">可能会用到require.context的场景</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#注册基础组件" class="sidebar-link">注册基础组件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#router模块自动导入" class="sidebar-link">router模块自动导入</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#插槽-slot" class="sidebar-link">插槽-slot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#" class="sidebar-link"></a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#watch-侦听器" class="sidebar-link">Watch——侦听器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#基础用法" class="sidebar-link">基础用法</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#立即触发" class="sidebar-link">立即触发</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#深度监听" class="sidebar-link">深度监听</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#随时监听-随时取消-了解一下-watch" class="sidebar-link">随时监听，随时取消，了解一下$watch</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#functional-函数式组件" class="sidebar-link">functional——函数式组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#函数式组件的代码" class="sidebar-link">函数式组件的代码</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#computed-计算属性" class="sidebar-link">computed——计算属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#基本用法" class="sidebar-link">基本用法</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#get和set" class="sidebar-link">get和set</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#filter-过滤器" class="sidebar-link">filter—— 过滤器</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#v-自定义指令" class="sidebar-link">v- ——自定义指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#开发v-loading指令" class="sidebar-link">开发v-loading指令</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#在元素上面使用指令" class="sidebar-link">在元素上面使用指令</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#项目中哪些场景可以自定义指令" class="sidebar-link">项目中哪些场景可以自定义指令</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#vue-observable-实现状态管理" class="sidebar-link">Vue.observable——实现状态管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#创建-store" class="sidebar-link">创建 store</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#在组件中引用" class="sidebar-link">在组件中引用</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#render函数-不懂" class="sidebar-link">render函数 不懂</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#自定义生命周期函数" class="sidebar-link">自定义生命周期函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#了解vue合并策略" class="sidebar-link">了解Vue合并策略</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#通过合并策略自定义生命周期函数" class="sidebar-link">通过合并策略自定义生命周期函数</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#自定义生命周期钩子函数" class="sidebar-link">自定义生命周期钩子函数</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#应用" class="sidebar-link">应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#生命周期" class="sidebar-link">生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#beforecreate和created" class="sidebar-link">beforeCreate和created</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#beforemounted和mounted" class="sidebar-link">beforeMounted和mounted</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#beforeupdate和updated" class="sidebar-link">beforeUpdate和updated</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#beforedestory和destoryed" class="sidebar-link">beforeDestory和destoryed</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#activated和deactivated" class="sidebar-link">activated和deactivated</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#hookevent-监听组件生命周期" class="sidebar-link">hookEvent——监听组件生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_1-内部监听生命周期函数" class="sidebar-link">1. 内部监听生命周期函数</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#_2-外部监听生命周期函数" class="sidebar-link">2. 外部监听生命周期函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#scope-样式穿透" class="sidebar-link">scope——样式穿透</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#动态组件-页面灵活渲染" class="sidebar-link">动态组件——页面灵活渲染</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#resize-监听事件" class="sidebar-link">resize——监听事件</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#settime-定时器使用" class="sidebar-link">setTime——定时器使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#方式一、挂着到this上" class="sidebar-link">方式一、挂着到this上</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#方式二、const命名" class="sidebar-link">方式二、const命名</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#方式三、请求完成再打开定时器" class="sidebar-link">方式三、请求完成再打开定时器</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#this-set-obj-key-value-响应式" class="sidebar-link">this.$set(obj,key,value)——响应式</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#策略模式" class="sidebar-link">策略模式</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#职责单一" class="sidebar-link">职责单一</a></li><li class="sidebar-sub-header"><a href="/vue/2.技巧-vue2.0.html#冻结渲染无关的数据" class="sidebar-link">冻结渲染无关的数据</a></li></ul></li><li><a href="/vue/3.组件-vue2.0.html" class="sidebar-link">组件</a></li><li><a href="/vue/4.优化-vue2.0.html" class="sidebar-link">优化</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue3.0</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>vue技巧</p> <h2 id="⭐⭐⭐vue通讯方式"><a href="#⭐⭐⭐vue通讯方式" class="header-anchor">#</a> ⭐⭐⭐vue通讯方式</h2> <ul><li>父子通信：父传子通过props，子向父通过events($emit);通过父链/子链（$parent/$children）;通过ref访问组件实例；provide/inject API(可以传孙子); $attrs/$listeners</li> <li>兄弟通信：Bus/vuex(配合localStorage实现持久化储存)</li> <li>跨组件通信：Bus/vuex/provide,inject/ $attrs、$listeners</li></ul> <h3 id="_1-parent-children-refs-父子组件"><a href="#_1-parent-children-refs-父子组件" class="header-anchor">#</a> 1.$parent,$children,$refs——父子组件</h3> <p>节制地使用 <code>$parent</code> 和 <code>$children</code> - 它们的主要目的是作为访问组件的应急方法。更推荐用 props 和 events 实现父子组件通信</p> <p>$refs 访问实例，调用该组件方法或访问数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addOrUpdate<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-props和-emit-父子组件"><a href="#_2-props和-emit-父子组件" class="header-anchor">#</a> 2.props和$emit ——父子组件</h3> <div class="language-vue extra-class"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>templete</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>son</span> <span class="token attr-name">:getInfo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getInfo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@refresh</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getSonInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>templete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
          	getInfo<span class="token operator">:</span> <span class="token string">'传递给子的数据'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        	<span class="token function">getSonInfo</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>          
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

// 子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>templete</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>toFather<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>{{getInfo}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>templete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'getInfo'</span><span class="token punctuation">]</span>
        methods<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function">toFather</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'refresh'</span><span class="token punctuation">,</span> <span class="token string">'测试'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_3-sync和v-model语法糖-父子组件"><a href="#_3-sync和v-model语法糖-父子组件" class="header-anchor">#</a> 3..sync和v-model语法糖——父子组件</h3> <h4 id="sync"><a href="#sync" class="header-anchor">#</a> .sync</h4> <p>限制：1.不能和表达式一起使用  v-bind:title.sync=&quot;doc.title + '!'&quot; 2.不能用在字面量对象上  v-bind.sync=&quot;{ title: doc.title }&quot;</p> <p>上诉2种均无效</p> <div class="language-vue extra-class"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update-info</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateInfoVisible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:isclosed.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateInfoVisible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update-info</span><span class="token punctuation">&gt;</span></span>

updateInfoVisible： false

// 子组件
props: {
    isclosed: Boolean
}
handleClosed () {
   this.$emit('update:isclosed', false)
}

// 父组件通过属性传值，通过.sync修饰  :isclosed.sync=&quot;updateInfoVisible&quot;
// 子组件通过props接收，通过 this.$emit('update:isclosed', false) 修改 
</code></pre></div><h4 id="v-model"><a href="#v-model" class="header-anchor">#</a> v-model</h4> <p>v-model其实是一个语法糖,即：v-bind动态绑定一个value属性，v-on给当前元素绑定input事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;message&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>等同于下面<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;message&quot;</span> v<span class="token operator">-</span>on<span class="token operator">:</span>input<span class="token operator">=</span><span class="token string">&quot;message=$event.target.value&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><h5 id="用法"><a href="#用法" class="header-anchor">#</a> 用法</h5> <div class="language-vue extra-class"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-page-tab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-sub-tab</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activeName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@tab-click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectTab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-sub-tab</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> SubTab <span class="token keyword">from</span> <span class="token string">'@/views/baseViews/tableView/subtab'</span>
    
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> SubTab<span class="token punctuation">,</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span>
      stayCheck
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        activeName<span class="token operator">:</span> <span class="token string">'stayCheck'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>// 子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$style[<span class="token punctuation">'</span>custom-sub-tab<span class="token punctuation">'</span>]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab-pane<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activeLine<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>active-line<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab-item<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in options<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.auth<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">:ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.name<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.index===selectIndex?<span class="token punctuation">'</span>active-tab<span class="token punctuation">'</span>:<span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clickTab(item)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.label }}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'custom-sub-tab'</span><span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// v-model 默认绑定 input事件</span>
      value<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> Array<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        selectIndex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        tabLabelWidth<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    watch<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// v-model的值</span>
      <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>selectIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> val
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_4-v-bind-props-v-bind-attrs-v-on-listener"><a href="#_4-v-bind-props-v-bind-attrs-v-on-listener" class="header-anchor">#</a> 4.v-bind=$props v-bind=$attrs v-on=$listener</h3> <div class="language-vue extra-class"><pre class="language-vue"><code>// 组件二次封装用到，可以直接把原组件的属性或者事件绑定到组件上
// 被二次封装的组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-progress-dp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>progress-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{progressTitle}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-progress</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-progress</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{openSum}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>/{{totalSum}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

// 使用组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-progress-dp</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other-sum<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:percentage</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>devicePercent.cloudPer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>#0080ff<span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

</code></pre></div><h3 id="_5-eventbus-跨组件"><a href="#_5-eventbus-跨组件" class="header-anchor">#</a> 5.eventBus——跨组件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 接收的组件</span>
  <span class="token keyword">import</span> eventBus <span class="token keyword">from</span> <span class="token string">'@/utils/eventBus.js'</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听</span>
    eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'clearAdvanceParamsByJump'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>advanceParamsByJump <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  
<span class="token comment">// 传值的组件</span>
<span class="token keyword">import</span> eventBus <span class="token keyword">from</span> <span class="token string">'@/utils/eventBus.js'</span>
<span class="token function">toView</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'clearAdvanceParamsByJump'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-vuex-跨组件"><a href="#_6-vuex-跨组件" class="header-anchor">#</a> 6.vuex ——跨组件</h3> <h4 id="基础介绍"><a href="#基础介绍" class="header-anchor">#</a> 基础介绍</h4> <div class="language-js extra-class"><pre class="language-js"><code>全局状态管理
    state 数据源
    mutation 变更数据源（唯一，必须是同步函数）
    action 处理异步任务，触发mutation变更数据
    getter 包装数据源，跟随state变化而变化，类似computed
持久化储存
	可以搭配localStorage或sessionStorage实现或者插件
    <span class="token keyword">let</span> defaultData <span class="token operator">=</span> <span class="token string">'上海'</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>defaultData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            defaultData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>loacalStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'defaultData'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	state<span class="token operator">:</span> <span class="token punctuation">{</span>
        city<span class="token operator">:</span> defaultData
    <span class="token punctuation">}</span>
	mutations处理储存
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>defaultData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span>loacalStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'defaultData'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">Stringify</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>city<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="安装使用"><a href="#安装使用" class="header-anchor">#</a> 安装使用</h4> <h5 id="_1-新建"><a href="#_1-新建" class="header-anchor">#</a> 1.新建</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.跟目录下插件store文件夹</span>
<span class="token comment">// 新建index.js  modules文件夹，actions.js getters.js mutations.js</span>
<span class="token comment">// 在index.js内</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> getters <span class="token keyword">from</span> <span class="token string">'./getters'</span>
<span class="token keyword">import</span> mutations <span class="token keyword">from</span> <span class="token string">'./mutations'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> actions <span class="token keyword">from</span> <span class="token string">'./actions'</span>
<span class="token keyword">import</span> user <span class="token keyword">from</span> <span class="token string">'./modules/user'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 导航条, 布局风格, defalut(默认) / inverse(反向)</span>
  navbarLayoutType<span class="token operator">:</span> <span class="token string">'inverse'</span><span class="token punctuation">,</span>
  <span class="token comment">// 侧边栏, 布局皮肤, light(浅色) / dark(黑色)</span>
  sidebarLayoutSkin<span class="token operator">:</span> <span class="token string">'dark'</span><span class="token punctuation">,</span>
  <span class="token comment">// 侧边栏, 水平折叠收起状态</span>
  sidebarCollapse<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// 侧边栏，头部按钮</span>
  sidebarHeader<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 常用菜单</span>
  menuIdChecked<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 页面文档可视高度(随窗口改变大小)</span>
  documentClientHeight<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token comment">// 菜单导航</span>
  menuNavList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  menuNavActiveName<span class="token operator">:</span> <span class="token string">'1-1'</span><span class="token punctuation">,</span>
  <span class="token comment">// 内容区域tabs标签页</span>
  contentTabs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  contentTabsActiveName<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">,</span>
  getters<span class="token punctuation">,</span>
  mutations<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    user <span class="token comment">// 模块化</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  strict<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_2-引入"><a href="#_2-引入" class="header-anchor">#</a> 2.引入</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//2. main.js</span>

<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'@/store'</span>         <span class="token comment">// api: https://github.com/vuejs/vuex</span>
<span class="token comment">/* eslint-disable no-new */</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  store<span class="token punctuation">,</span> <span class="token comment">// 将store实例注入到组件内，通过this.$store访问</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;App/&gt;'</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>App<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_3-使用"><a href="#_3-使用" class="header-anchor">#</a> 3.使用</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>state<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// store文件夹下的index.js</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token string">'xxx'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 1.通过computed获得state里的数据源</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">count</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>count
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">// 2.mapState辅助函数 减少代码量</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
computed<span class="token operator">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 箭头函数可使代码更简练</span>
    <span class="token function-variable function">count</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
    <span class="token comment">// 传字符串参数 'count' 等同于 `state =&gt; state.count`</span>
    countAlias<span class="token operator">:</span> <span class="token string">'count'</span><span class="token punctuation">,</span>
    <span class="token comment">// 为了能够使用 `this` 获取局部状态，必须使用常规函数</span>
    <span class="token function">countPlusLocalState</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>localCount
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 3.当映射的计算属性的名称与 state 的子节点名称相同时，我们也可以给 mapState 传一个字符串数组。</span>
computed<span class="token operator">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">// 映射 this.count 为 store.state.count</span>
  <span class="token string">'count'</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 4.当已经写了很多计算属性，可以使用扩展运算符</span>

 
computed<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">//原来的继续保留</span>
    <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">}</span>
    <span class="token comment">//再维护vuex</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">//这里的...不是省略号了,是对象扩展符</span>
        count<span class="token operator">:</span><span class="token string">'count'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>getters<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// store文件夹下的index.js</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    todos<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 参数一，state，参数二其他getters</span>
    <span class="token function-variable function">doneTodos</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> getters</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>done<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token comment">// 类似store的计算属性</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1.通过computed访问</span>
computed<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">doneTodosCount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>doneTodosCount
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2. 访问方法</span>
getters<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function-variable function">getTodoById</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span><span class="token function">getTodoById</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; { id: 2, text: '...', done: false }</span>
<span class="token comment">// 3. mapGetters辅助函数</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapGetters <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用对象展开运算符将 getter 混入 computed 对象中</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'doneTodosCount'</span><span class="token punctuation">,</span>
      <span class="token string">'anotherGetter'</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
  <span class="token comment">// 如果你想将一个 getter 属性另取一个名字，使用对象形式：</span>
<span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 把 `this.doneCount` 映射为 `this.$store.getters.doneTodosCount`</span>
  doneCount<span class="token operator">:</span> <span class="token string">'doneTodosCount'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>mutations<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>必须是同步函数<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// state数据源，n其他参数</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 变更状态</span>
      state<span class="token punctuation">.</span>count<span class="token operator">+=</span> n<span class="token punctuation">.</span>num
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1. 使用</span>
methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handlerOne</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>num<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2.对象方式的提交</span>
methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handlerOne</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'increment'</span><span class="token punctuation">,</span>
            num<span class="token operator">:</span> <span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用常量替代 Mutation 事件类型</span>
    <span class="token comment">// mutation-types.js</span>
    <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SOME_MUTATION</span> <span class="token operator">=</span> <span class="token string">'SOME_MUTATION'</span>
	<span class="token comment">// store.js</span>
    <span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">SOME_MUTATION</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./mutation-types'</span>

    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      state<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 我们可以使用 ES2015 风格的计算属性命名功能来使用一个常量作为函数名</span>
        <span class="token punctuation">[</span><span class="token constant">SOME_MUTATION</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// mutate state</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token comment">// 用不用常量取决于你——在需要多人协作的大型项目中，这会很有帮助。但如果你不喜欢，你完全可以不这样做。</span>
 <span class="token comment">// 3.mapMutations 辅助函数</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> mapMutations <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token comment">// 将 `this.increment()` 映射为 `this.$store.commit('increment')`</span>

      <span class="token comment">// `mapMutations` 也支持载荷：</span>
      <span class="token string">'incrementBy'</span> <span class="token comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit('incrementBy', amount)`</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      add<span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token comment">// 将 `this.add()` 映射为 `this.$store.commit('increment')`</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>，
    <span class="token function">handleAdd</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>actions<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// index.js</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token comment">// 或解构</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 使用</span>
    <span class="token comment">// 以载荷形式分发</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'incrementAsync'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      amount<span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 以对象形式分发</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">'incrementAsync'</span><span class="token punctuation">,</span>
      amount<span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// mapActions辅助函数</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapActions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token comment">// 将 `this.increment()` 映射为 `this.$store.dispatch('increment')`</span>
      <span class="token comment">// `mapActions` 也支持载荷：</span>
      <span class="token string">'incrementBy'</span> <span class="token comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch('incrementBy', amount)`</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      add<span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token comment">// 将 `this.add()` 映射为 `this.$store.dispatch('increment')`</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>，
  <span class="token function">handleA</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>module 模块化<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">/**
 * 数据统计tab跳转其他tab
 */</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> types <span class="token keyword">from</span> <span class="token string">'../mutation-types'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  jumpInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 绝对不能用解构</span>
<span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">CLEAR_JUMP_INFO</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">UPDATE_JUMP_INFO</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>jumpInfo <span class="token operator">=</span> info
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  state<span class="token punctuation">,</span>
  getters<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
  mutations
<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
    computed<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token string">'statisticsJump'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'jumpInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token string">'statisticsJump'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>updateInfo<span class="token operator">:</span> <span class="token string">'UPDATE_JUMP_INFO'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-solt作用域插槽-父子组件"><a href="#_7-solt作用域插槽-父子组件" class="header-anchor">#</a> 7.solt作用域插槽——父子组件</h3> <p>v-slot:插槽名   简写： #插槽名</p> <p>获取子组件数据： v-slot:插槽名='slotProps' 或解构 v-slot:插槽名=&quot;{name}&quot;</p> <p>v-slot只能在template使用，如果只有使用一个插槽，可以在组件标签上使用</p> <div class="language-vue extra-class"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$style[<span class="token punctuation">'</span>text-grid<span class="token punctuation">'</span>]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      // {valueText} 或slotProps里拿子组件传递来的值
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-view</span> <span class="token attr-name">#top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{valueText}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:textList</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>textList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>valueText===<span class="token punctuation">'</span>1<span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{valueText}}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
   <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
		<span class="token comment">// 传递给子组件的值</span>
        textList<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token number">0</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token number">1</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token number">2</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token string">'4'</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token number">3</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
// 子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      // 循环父组件的list
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in textList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.key<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        // 传递给插槽，由插槽的slotProps拿该数据
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'child-view'</span><span class="token punctuation">,</span>
    <span class="token comment">// 拿到父组件的数据</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'textList'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_8-provide、inject-父子孙组件"><a href="#_8-provide、inject-父子孙组件" class="header-anchor">#</a> 8.provide、inject——父子孙组件</h3> <p>提示：<code>provide</code> 和 <code>inject</code> 绑定并不是可响应的。这是刻意为之的。然而，如果你传入了一个可监听的对象，那么其对象的 property 还是可响应的。</p> <ul><li><strong>provide</strong>：<code>Object | () =&gt; Object</code></li> <li><strong>inject</strong>：<code>Array&lt;string&gt; | { [key: string]: string | Symbol | Object }</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父级组件提供 'foo'</span>
<span class="token keyword">var</span> Provider <span class="token operator">=</span> <span class="token punctuation">{</span>
  provide<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token string">'bar'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 子组件注入 'foo'</span>
<span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">{</span>
  inject<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">)</span> <span class="token comment">// =&gt; &quot;bar&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接下来 2 个例子只工作在 Vue 2.2.1 或更高版本。低于这个版本时，注入的值会在 <code>props</code> 和 <code>data</code> 初始化之后得到。在 2.5.0+ 的注入可以通过设置默认值使其变成可选项：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">{</span>
  inject<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="技巧"><a href="#技巧" class="header-anchor">#</a> 技巧</h4> <p>子(或更低层)组件中直接调用父组件(或更高层)的方法</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>inject-test</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>inject-test</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> InjectTest <span class="token keyword">from</span> <span class="token string">&quot;./injectTest&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
        components<span class="token operator">:</span> <span class="token punctuation">{</span>InjectTest<span class="token punctuation">}</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'ProvideTest'</span><span class="token punctuation">,</span>
        <span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                parentTest<span class="token operator">:</span><span class="token keyword">this</span> <span class="token comment">//通过provide提供自身所有属性</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击我调用父组件方法<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
 
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'InjectTest'</span><span class="token punctuation">,</span>
        inject<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'parentTest'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">//子组件调用父组件方法</span>
            <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>parentTest<span class="token punctuation">.</span><span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token string">&quot;message!&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_9-dispatch、broadcast-父子孙组件"><a href="#_9-dispatch、broadcast-父子孙组件" class="header-anchor">#</a> 9.dispatch、broadcast——父子孙组件</h3> <p><strong>$dispatch</strong> 与 <strong>$broadcast</strong> 已废弃，自行实现dispatch（下级向上级派发）、broadcast（上级向下级广播）方法</p> <ul><li>在⼦组件调⽤ dispatch ⽅法，向上级指定的组件实例（最近 的）上触发⾃定义事件，并传递数据，且该上级组件已预先通 过 $on 监听了这个事件；</li> <li>相反，在⽗组件调⽤ broadcast ⽅法，向下级指定的组件实例 （最近的）上触发⾃定义事件，并传递数据，且该下级组件已 预先通过 $on 监听了这个事件。</li></ul> <h4 id="mixin文件"><a href="#mixin文件" class="header-anchor">#</a> mixin文件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">broadcast</span> <span class="token punctuation">(</span><span class="token parameter">componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> child<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> componentName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      child<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">broadcast</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">[</span>componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>params<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span> <span class="token punctuation">(</span><span class="token parameter">componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$root
      <span class="token keyword">let</span> name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name
      <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> name <span class="token operator">!==</span> componentName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>$parent
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parent<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> <span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">broadcast</span> <span class="token punctuation">(</span><span class="token parameter">componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">broadcast</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="broadcast广播"><a href="#broadcast广播" class="header-anchor">#</a> broadcast广播</h4> <div class="language- extra-class"><pre class="language-text"><code>父组件广播，就需要子组件created或mounted 监听自定义事件
子：this.$on('自定义事件'， 触发事件)
父：this.broadcast('要广播的组件名字', '自定义事件', 参数：obj或单一参数)
</code></pre></div><h4 id="dispatch派发"><a href="#dispatch派发" class="header-anchor">#</a> dispatch派发</h4> <div class="language- extra-class"><pre class="language-text"><code>子组件派发，就需要父组件created或mounted 监听自定义事件
父：this.$on('自定义事件'， 触发事件)
子：this.broadcast('要派发的组件名字', '自定义事件', 参数：obj或单一参数)
</code></pre></div><h4 id="缺点-无法实现兄弟组件通信"><a href="#缺点-无法实现兄弟组件通信" class="header-anchor">#</a> 缺点：无法实现兄弟组件通信</h4> <h3 id="_10、findcomponents方法-找到任意组件实例"><a href="#_10、findcomponents方法-找到任意组件实例" class="header-anchor">#</a> 10、findComponents方法（找到任意组件实例）</h3> <p>自行实现，以工具函数形式来使用，组件通信的终极方法。通过递归、遍历找到组件的name选项匹配的组件实例并返回。使用：通过返回的目标实例，调用方法或数据。(utils/assist.js)</p> <p>它适⽤于以下场景：</p> <ul><li>由⼀个组件，向上找到最近的指定组件；</li> <li>由⼀个组件，向上找到所有的指定组件；</li> <li>由⼀个组件，向下找到最近的指定组件；</li> <li>由⼀个组件，向下找到所有指定的组件；</li> <li>由⼀个组件，找到指定组件的兄弟组件。</li></ul> <h4 id="向上找到最近的指定组件-findcomponentupward"><a href="#向上找到最近的指定组件-findcomponentupward" class="header-anchor">#</a> 向上找到最近的指定组件**——findComponentUpward**</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// assist.js </span>
<span class="token comment">// 由⼀个组件，向上找到最近的指定组件 </span>
<span class="token comment">// context组件实例，componentName组件名称</span>
<span class="token keyword">function</span> <span class="token function">findComponentUpward</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">let</span> parent <span class="token operator">=</span> context<span class="token punctuation">.</span>$parent 
    <span class="token keyword">let</span> name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name 
    <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> <span class="token punctuation">[</span>componentName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>$parent<span class="token punctuation">;</span> 
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> parent 
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> findComponentUpward <span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子组件</span>
<span class="token keyword">const</span> comA <span class="token operator">=</span> <span class="token function">findComponentUpward</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'componentA'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>comA<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>comA<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	comA<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="向上找到所有的指定组件-findcomponentsupward"><a href="#向上找到所有的指定组件-findcomponentsupward" class="header-anchor">#</a> 向上找到所有的指定组件**——** <strong>findComponentsUpward</strong></h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// assist.js </span>
<span class="token comment">// 由⼀个组件，向上找到所有的指定组件 </span>
<span class="token keyword">function</span> <span class="token function">findComponentsUpward</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">let</span> parents <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> parent <span class="token operator">=</span> context<span class="token punctuation">.</span>$parent
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name <span class="token operator">===</span> componentName<span class="token punctuation">)</span> parents<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    	<span class="token keyword">return</span> parents<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">findComponentsUpward</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> componentName<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> 
    	<span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> findComponentsUpward <span class="token punctuation">}</span>
</code></pre></div><h4 id="向下找到最近的指定组件-findcomponentdownward"><a href="#向下找到最近的指定组件-findcomponentdownward" class="header-anchor">#</a> 向下找到最近的指定组件**——** <strong>findComponentDownward</strong></h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">findComponentDownward</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	<span class="token keyword">const</span> childrens <span class="token operator">=</span> context<span class="token punctuation">.</span>$children
	<span class="token keyword">let</span> children <span class="token operator">=</span> <span class="token keyword">null</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>childrens<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> child <span class="token keyword">of</span> childrens<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
			<span class="token keyword">const</span> name <span class="token operator">=</span> child<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name 
			<span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> componentName<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
				children <span class="token operator">=</span> child 
				<span class="token keyword">break</span> 
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				children <span class="token operator">=</span> <span class="token function">findComponentDownward</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> componentName<span class="token punctuation">)</span> 
				<span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">)</span> <span class="token keyword">break</span> 
			<span class="token punctuation">}</span> 
		<span class="token punctuation">}</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> children 
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> findComponentDownward <span class="token punctuation">}</span>
</code></pre></div><h4 id="向下找到所有指定的组件-findcomponentsdownward"><a href="#向下找到所有指定的组件-findcomponentsdownward" class="header-anchor">#</a> 向下找到所有指定的组件**——** <strong>findComponentsDownward</strong></h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// assist.js </span>
<span class="token comment">// 由⼀个组件，向下找到所有指定的组件 </span>
<span class="token keyword">function</span> <span class="token function">findComponentsDownward</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> context<span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">components<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name <span class="token operator">===</span> componentName<span class="token punctuation">)</span> components<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    	<span class="token keyword">const</span> foundChilds <span class="token operator">=</span> <span class="token function">findComponentsDownward</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> componentName<span class="token punctuation">)</span> 
    	<span class="token keyword">return</span> components<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>foundChilds<span class="token punctuation">)</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> findComponentsDownward <span class="token punctuation">}</span>
</code></pre></div><h4 id="找到指定组件的兄弟组件-findbrotherscomponents"><a href="#找到指定组件的兄弟组件-findbrotherscomponents" class="header-anchor">#</a> 找到指定组件的兄弟组件**——** <strong>findBrothersComponents</strong></h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// assist.js </span>
<span class="token comment">// 由⼀个组件，找到指定组件的兄弟组件 </span>
<span class="token keyword">function</span> <span class="token function">findBrothersComponents</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> componentName<span class="token punctuation">,</span> exceptMe <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	<span class="token keyword">let</span> res <span class="token operator">=</span> context<span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name <span class="token operator">===</span> componentName 
    <span class="token punctuation">}</span><span class="token punctuation">)</span> 
    <span class="token keyword">let</span> index <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>_uid <span class="token operator">===</span> context<span class="token punctuation">.</span>_uid<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>exceptMe<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> findBrothersComponents <span class="token punctuation">}</span>
</code></pre></div><p>相⽐其它 4 个函数，findBrothersComponents 多了⼀个参数 exceptMe，是否把本身除外，默认是 true。寻找兄弟组件的⽅ 法，是先获取 context.$parent.$children，也就是⽗组件的 全部⼦组件，这⾥⾯当前包含了本身，所有也会有第三个参数 exceptMe。Vue.js 在渲染组件时，都会给每个组件加⼀个内置的属 性 _uid，这个 _uid 是不会重复的，借此我们可以从⼀系列兄弟组 件中把⾃⼰排除掉。</p> <h2 id="⭐⭐⭐minxins-组件内容的复用"><a href="#⭐⭐⭐minxins-组件内容的复用" class="header-anchor">#</a> ⭐⭐⭐minxins——组件内容的复用</h2> <p>mixins是Vue提供的一种混合机制，用来更高效的实现组件内容的复用。</p> <p>在<code>Vue</code>中，一个混入对象可以包含任意组件选项，但是对于不同的组件选项，会有不同的合并策略。</p> <ol><li><code>data</code> 对于<code>data</code>,在混入时会进行递归合并，如果两个属性发生冲突，则以组件自身为主，如上例中的<code>chart</code>属性。</li> <li>生命周期钩子函数，混入时会将同名钩子函数加入到一个数组中，然后在调用时依次执行。混入对象里面的钩子函数会优先于组件的钩子函数执行。如果一个组件混入了多个对象，对于混入对象里面的同名钩子函数，将按照数组顺序依次执行</li> <li>其他选项 对于值为对象的选项，如<code>methods</code>,<code>components</code>,<code>filter</code>,<code>directives</code>,<code>props</code>等等，将被合并为同一个对象。两个对象键名冲突时，取组件对象的键值对。</li></ol> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <p><strong>textMixin.js</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 混入代码 resize-mixins.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> debounce <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lodash'</span>
<span class="token keyword">const</span> resizeChartMethod <span class="token operator">=</span> <span class="token string">'$__resizeChartMethod'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在组件内部将图表init的引用映射到chart属性上</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      chart<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">[</span>resizeChartMethod<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'reisze'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">[</span>resizeChartMethod<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过lodash的防抖函数来控制resize的频率</span>
    <span class="token punctuation">[</span>resizeChartMethod<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>chart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>chart<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>index.vue</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!--图表组件代码--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>chart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> echartMixins <span class="token keyword">from</span> <span class="token string">'./echarts-mixins'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// mixins属性用于导入混入，是一个数组，数组可以传入多个混入对象</span>
  mixins<span class="token operator">:</span> <span class="token punctuation">[</span>echartMixins<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      chart<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="全局混入"><a href="#全局混入" class="header-anchor">#</a> 全局混入</h3> <div class="language- extra-class"><pre class="language-text"><code>Vue.mixin({
  methods: {
    /**
     * 将埋点方法通过全局混入添加到每个组件内部
     * 
     * 建议将埋点方法绑定到Vue的原型链上面，如： Vue.prototype.$track = () =&gt; {}
     * */
    track(message) {
      console.log(message)
    }
  }
})
</code></pre></div><h2 id="⭐⭐⭐vue-use"><a href="#⭐⭐⭐vue-use" class="header-anchor">#</a> ⭐⭐⭐Vue.use</h2> <p>Vue插件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 插件</span>
<span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">install</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'我是install内的代码'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化插件</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 页面显示&quot;我是install内的代码&quot;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
    
<span class="token comment">// 类似element组件注册</span>
<span class="token comment">// components的custom-echart-pie内的index.js</span>
<span class="token keyword">import</span> customEchartPie <span class="token keyword">from</span> <span class="token string">'./index.vue'</span>

<span class="token keyword">const</span> CustomEchartPie <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">install</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'CustomEchartPie'</span><span class="token punctuation">,</span> customEchartPie<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> CustomEchartPie
<span class="token comment">// components的custom-echart-pie内的index.vue</span>
组件代码

<span class="token comment">// components的index.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> CustomEchartPie <span class="token keyword">from</span> <span class="token string">'./custom-echart-pie/index'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>CustomEchartPie<span class="token punctuation">)</span>
</code></pre></div><h4 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h4> <ol><li>Vue的插件是一个<strong>对象</strong>, 就像<code>Element</code>.</li> <li>插件<strong>对象</strong>必须有<code>install</code>字段.</li> <li><code>install</code>字段是一个函数.</li> <li>初始化插件<strong>对象</strong>需要通过<code>Vue.use()</code>.</li></ol> <h4 id="扩展学习"><a href="#扩展学习" class="header-anchor">#</a> 扩展学习</h4> <ol><li><code>Vue.use()</code>调用必须在<code>new Vue</code>之前.</li> <li>同一个插件多次使用Vue.use()也只会被运行一次.</li></ol> <h2 id="vue-prototype-xx"><a href="#vue-prototype-xx" class="header-anchor">#</a> Vue.prototype.$xx</h2> <p>在Vue实例上挂载一个方法/属性，可以直接调用</p> <p>原型链原理。</p> <p>实例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// component下的singleton文件夹的index.js  全局自动化注册</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> singleton <span class="token operator">=</span> <span class="token function">context</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default
  <span class="token keyword">if</span> <span class="token punctuation">(</span>singleton <span class="token operator">&amp;&amp;</span> singleton<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>singleton<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> singleton
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// component下的singleton文件夹的custom-charts-preview的index.js </span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Comp <span class="token keyword">from</span> <span class="token string">'./index.vue'</span>

<span class="token keyword">let</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Comp<span class="token punctuation">)</span>
<span class="token keyword">let</span> instance

<span class="token keyword">const</span> CustomChartsPreview <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * @options {{images}}
     * @images: 必须，图片src数组
     */</span>
    <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            instance<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        instance<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'$CustomChartsPreview'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> CustomChartsPreview

<span class="token comment">// component下的singleton文件夹的custom-charts-preview的index.vue</span>
组件内容

</code></pre></div><h2 id="vue组件使用方式"><a href="#vue组件使用方式" class="header-anchor">#</a> vue组件使用方式</h2> <p>写好子组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>color<span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- 插槽 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> Button<span class="token punctuation">,</span>
  <span class="token comment">// 传入子组件的参数写到props</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token comment">// 颜色参数类型</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;#000&quot;</span>  <span class="token comment">// 默认黑色</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.btn</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 110px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="普通组件"><a href="#普通组件" class="header-anchor">#</a> 普通组件</h3> <ol><li>引入组件</li> <li>在components中声明</li> <li>在template使用</li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 3. 在模版语法中使用 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>red<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是插槽的值<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// 1. 在页面种引用组件</span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'@/components/Button.vue'</span>
  
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 2. 在components中声明组件</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    Button
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>一般公用组件放在component文件夹内，view同级（放置页面）</p></div> <h3 id="全局组件-component"><a href="#全局组件-component" class="header-anchor">#</a> 全局组件-component</h3> <p>只能一个一个注册</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span> 
<span class="token comment">// 引入Button组件 </span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'./Button.vue'</span><span class="token punctuation">;</span> 
<span class="token comment">// 将loading注册为全局组件，在别的组件中通过&lt;Button&gt;标签使用Loading组件 </span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'Button'</span><span class="token punctuation">,</span> Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="全局组件-插件"><a href="#全局组件-插件" class="header-anchor">#</a> 全局组件-插件</h3> <ol><li>子组建添加install方法</li> <li>在main.js中引用</li> <li>使用Vue.use（）方法</li> <li>在页面中使用</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Button.js </span>

<span class="token keyword">import</span> ButtonComponent <span class="token keyword">from</span> <span class="token string">'./Button.vue'</span>

<span class="token comment">// 1.添加install方法 （插件方法）</span>
<span class="token keyword">const</span> Button <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&quot;Button&quot;</span><span class="token punctuation">,</span> ButtonComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 导出Button</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Button

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>也可处理多个全局组件，install可以处理更多事情</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Button.js </span>

<span class="token keyword">import</span> ButtonComponent1 <span class="token keyword">from</span> <span class="token string">'./Button1.vue'</span>
<span class="token keyword">import</span> ButtonComponent2 <span class="token keyword">from</span> <span class="token string">'./Button2.vue'</span>
<span class="token keyword">import</span> ButtonComponent3 <span class="token keyword">from</span> <span class="token string">'./Button3.vue'</span>

<span class="token keyword">const</span> buttonList <span class="token operator">=</span> <span class="token punctuation">[</span>
    ButtonComponent1<span class="token punctuation">,</span>
    ButtonComponent2<span class="token punctuation">,</span>
    ButtonComponent3
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 1.添加install方法 （插件方法）</span>
<span class="token keyword">const</span> Button <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">Vue，options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    buttonList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">button</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// 这里 使用每个组件的 name 属性作为组件名</span>
        Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
  <span class="token comment">// 更多事情</span>
      <span class="token comment">// 添加全局方法或属性</span>
  Vue<span class="token punctuation">.</span><span class="token function-variable function">myGlobalMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 逻辑...</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 添加全局资源</span>
  Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'my-directive'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">bind</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> oldVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 逻辑...</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 注入组件选项</span>
  Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 逻辑...</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 添加实例方法</span>
  <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$myMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">methodOptions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 逻辑...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 导出Button</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Button
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token comment">// 2. 导入 </span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'@/components/Button.js'</span>
<span class="token comment">// 3. 使用 必须在new Vue之前</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>// 4 任意页面，比如app.vue

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 5. 在页面上使用 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是全局按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="构造组件"><a href="#构造组件" class="header-anchor">#</a> 构造组件</h3> <ol><li>Vue.extend 构建组件</li> <li>挂载到Vue.prototype</li> <li>在页面的script内使用</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 构建组件</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// 将复用的页面导入</span>
<span class="token keyword">import</span> Comp <span class="token keyword">from</span> <span class="token string">'./index.vue'</span>
<span class="token comment">// 构造组件</span>
<span class="token keyword">let</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Comp<span class="token punctuation">)</span>
<span class="token keyword">let</span> instance
<span class="token keyword">const</span> CustomFieldSetting <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//options: {code:动态表code, max:最大勾选数, title:标题}, callback: 确定后的回调</span>
<span class="token function">    show </span><span class="token punctuation">(</span><span class="token parameter">options<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">!</span>instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 创造实例，isntance就相当于vue的this</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token comment">// 渲染</span>
            instance<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token comment">// 挂载</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        instance<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> CustomFieldSetting
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 2.挂载到prototype</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> CustomFieldSetting <span class="token keyword">from</span> <span class="token string">'./custom-field-setting'</span>

<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$CustomFieldSetting <span class="token operator">=</span> CustomFieldSetting
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 3.页面上使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$CustomFieldSetting<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="代码实例-vue-extend-单列模式"><a href="#代码实例-vue-extend-单列模式" class="header-anchor">#</a> 代码实例(Vue.extend+单列模式)</h4> <h5 id="单列模式"><a href="#单列模式" class="header-anchor">#</a> 单列模式</h5> <p>在使用element时候用到全局组件，比如loading, notify,message等</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> loading1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment">// 这时候你会发现，我调用了两次loading,但是只出现了一个，而且我只关闭了loading，但是loading1也被关闭了。</span>
</code></pre></div><h5 id="实现方式"><a href="#实现方式" class="header-anchor">#</a> 实现方式</h5> <h6 id="开发loading组件"><a href="#开发loading组件" class="header-anchor">#</a> 开发<code>loading</code>组件</h6> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-loading-fade<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--loading蒙版--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-loading-mask<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--loading中间的图标--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-loading-spinner<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-spinner-icon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--loading上面显示的文字--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-loading-text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ text }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 是否显示loading</span>
    visible<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// loading上面的显示文字</span>
    text<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>开发出来<code>loading</code>组件之后，如果需要直接使用，就要这样去用</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component-code<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--其他一堆代码--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-loading</span> <span class="token attr-name">:visible</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>加载中<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      visible<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但这样使用并不能满足我们的需求</p> <ol><li>可以通过js直接调用方法来显示关闭</li> <li><code>loading</code>可以将整个页面全部遮罩起来</li></ol> <h6 id="通过vue-extend将组件转换为全局组件"><a href="#通过vue-extend将组件转换为全局组件" class="header-anchor">#</a> 通过<code>Vue.extend</code>将组件转换为全局组件</h6> <ol><li>改造<code>loading</code>组件，将组件的<code>props</code>改为<code>data</code></li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code>export default {
  data() {
    return {
      text: '',
      visible: false
    }
  }
}
</code></pre></div><ol start="2"><li>通过<code>Vue.extend</code>改造组件</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// loading/index.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> LoadingComponent <span class="token keyword">from</span> <span class="token string">'./loading.vue'</span>

<span class="token comment">// 通过Vue.extend将组件包装成一个子类</span>
<span class="token keyword">const</span> LoadingConstructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>LoadingComponent<span class="token punctuation">)</span>

<span class="token keyword">let</span> loading <span class="token operator">=</span> <span class="token keyword">undefined</span>

<span class="token class-name">LoadingConstructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">close</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果loading 有引用，则去掉引用</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    loading <span class="token operator">=</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 先将组件隐藏</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token comment">// 延迟300毫秒，等待loading关闭动画执行完之后销毁组件</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 移除挂载的dom元素</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 调用组件的$destroy方法进行组件销毁</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">Loading</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果组件已渲染，则返回即可</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> loading
  <span class="token punctuation">}</span>
  <span class="token comment">// 要挂载的元素</span>
  <span class="token keyword">const</span> parent <span class="token operator">=</span> document<span class="token punctuation">.</span>body
  <span class="token comment">// 组件属性</span>
  <span class="token keyword">const</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>
    text<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>options
  <span class="token punctuation">}</span>
  <span class="token comment">// 通过构造函数初始化组件 相当于 new Vue()</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoadingConstructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> opts
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 将loading元素挂在到parent上面</span>
  parent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
  <span class="token comment">// 显示loading</span>
  Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 将组件实例赋值给loading</span>
  loading <span class="token operator">=</span> instance
  <span class="token keyword">return</span> instance
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Loading
</code></pre></div><ol start="3"><li>在页面使用loading</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">'./loading/index.js'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">Loading</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'正在加载。。。'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 三秒钟后关闭</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过上面的改造，loading已经可以在全局使用了，如果需要像<code>element-ui</code>一样挂载到<code>Vue.prototype</code>上面，通过<code>this.$loading</code>调用，还需要改造一下</p> <h6 id="将组件挂载到vue-prototype上面"><a href="#将组件挂载到vue-prototype上面" class="header-anchor">#</a> 将组件挂载到<code>Vue.prototype</code>上面</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$loading <span class="token operator">=</span> Loading
<span class="token comment">// 在export之前将Loading方法进行绑定</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Loading

<span class="token comment">// 在组件内使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="二次封装组件"><a href="#二次封装组件" class="header-anchor">#</a> 二次封装组件</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>$attrs</code>: 当组件在调用时传入的属性没有在<code>props</code>里面定义时，传入的属性将被绑定到<code>$attrs</code>属性内（<code>class</code>与<code>style</code>除外，他们会挂载到组件最外层元素上）。并可通过<code>v-bind=&quot;$attrs&quot;</code>传入到内部组件中。</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>$listeners</code>: 当组件被调用时，外部监听的这个组件的所有事件都可以通过<code>$listeners</code>获取到。并可通过<code>v-on=&quot;$listeners&quot;</code>传入到内部组件中。(使用修饰符.native无效)</p></div> <h3 id="比如二次封装el-dialog"><a href="#比如二次封装el-dialog" class="header-anchor">#</a> 比如二次封装el-dialog</h3> <h4 id="定义基本弹框代码"><a href="#定义基本弹框代码" class="header-anchor">#</a> 定义基本弹框代码</h4> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visibleDialog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">append-to-body</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--内容区域的默认插槽--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--使用弹框的footer插槽添加按钮--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#footer</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--对外继续暴露footer插槽，有个别弹框按钮需要自定义--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--将取消与确定按钮集成到内部--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleCancel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>取 消<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleConfirm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            确 定
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对外暴露visible属性，用于显示隐藏弹框</span>
    visible<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过计算属性，对.sync进行转换，外部也可以直接使用visible.sync</span>
    visibleDialog<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>visible<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:visible&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对外抛出cancel事件</span>
    <span class="token function">$_handleCancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;cancel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 对外抛出 confirm事件</span>
    <span class="token function">$_handleConfirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;confirm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="使用二次组件"><a href="#使用二次组件" class="header-anchor">#</a> 使用二次组件</h4> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!--外部使用方式 confirm cancel 是自定义的事件 opened是包装el-dialog的事件，通过$listeners传入到el-dialog里面--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-dialog</span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visibleDialog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@opened</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleOpened<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@confirm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleConfirm<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@cancel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleCancel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这是一段内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-dialog</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但上面的代码存在一个问题，无法将Dialog自身的属性和事件暴露到外部（虽然可以通过props及$emit一个一个添加，但是很麻烦）,这时候就可以使用$attrs与$listeners</p> <h4 id="使用-attrs与-listeners"><a href="#使用-attrs与-listeners" class="header-anchor">#</a> 使用<code>$attrs</code>与<code>$listeners</code></h4> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!---使用了v-bind与v-on监听属性与事件--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visibleDialog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--其他代码不变--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">//默认情况下父作用域的不被认作 props 的 attribute 绑定 (attribute bindings) </span>
    <span class="token comment">//将会“回退”且作为普通的 HTML attribute 应用在子组件的根元素上。</span>
    <span class="token comment">//通过设置 inheritAttrs 到 false，这些默认行为将会被去掉</span>
    inheritAttrs<span class="token operator">:</span> <span class="token boolean">false</span>
 <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!---外部使用方式--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-dialog</span>
  <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visibleDialog<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>测试弹框<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@opened</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleOpened<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  这是一段内容
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-dialog</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="对于-attrs-也可以使用-props来代替"><a href="#对于-attrs-也可以使用-props来代替" class="header-anchor">#</a> 对于<code>$attrs</code>，也可以使用<code>$props</code>来代替</h4> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visibleDialog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$props<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--其他代码不变--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> Dialog <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将Dialog的props通过扩展运算符展开到props属性里面</span>
    <span class="token operator">...</span>Dialog<span class="token punctuation">.</span>props
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但上面的代码存在一定的缺陷，有些组件存在非<code>props</code>的属性，比如对于一些封装的表单组件，我们可能需要给组件传入原生属性，但实际原生属性并没有在组件的<code>props</code>上面定义，这时候，如果通过上面的方式去包装组件，那么这些原生组件将无法传递到内部组件里面。</p> <h2 id="require-context-前端工程自动化"><a href="#require-context-前端工程自动化" class="header-anchor">#</a> require.context——前端工程自动化</h2> <p><code>require.context</code>是一个<code>webpack</code>提供的Api,通过执行<code>require.context</code>函数获取一个特定的上下文,主要是用于实现自动化导入模块。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
* @param directory 要搜索的文件夹目录，不能是变量，否则在编译阶段无法定位目录
* @param useSubdirectories  是否搜索子目录
* @param regExp 匹配文件的正则表达式
* @return function 返回一个具有 resolve, keys, id 三个属性的方法
          resolve() 它返回请求被解析后得到的模块 id
          keys() 它返回一个数组，由所有符合上下文模块处理的请求组成。 
          id 是上下文模块里面所包含的模块 id. 它可能在你使用 module.hot.accept 的时候被用到
*/</span>
require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>directory <span class="token operator">=</span> <span class="token string">'demo'</span><span class="token punctuation">,</span> useSubdirectories <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
</code></pre></div><p>当一个js里面需要手动引入过多的其他文件夹里面的文件时，就可以使用。</p> <h3 id="可能会用到require-context的场景"><a href="#可能会用到require-context的场景" class="header-anchor">#</a> 可能会用到<code>require.context</code>的场景</h3> <ol><li>当我们路由页面比较多的时候，可能会将路由文件拆分成多个，然后再通过<code>import</code>引入到<code>index.js</code>路由主入口文件中</li> <li>当使用svg symbol时候，需要将所有的svg图片导入到系统中（建议使用svg-sprite-loader）</li> <li>开发了一系列基础组件，然后把所有组件都导入到<code>index.js</code>中，然后再放入一个数组中，通过遍历数组将所有组件进行安装。</li></ol> <h3 id="注册基础组件"><a href="#注册基础组件" class="header-anchor">#</a> 注册基础组件</h3> <p>在components里注册了一系列组件</p> <p>components--index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
<span class="token comment">/**
*	context.keys() 返回所有匹配到的文件路径
*/</span>
context<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过context(key)可以获取到对应的文件，default表示export default 导出的内容</span>
  <span class="token keyword">let</span> component <span class="token operator">=</span> <span class="token function">context</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default
  <span class="token comment">// 安装vue组件</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在主入口文件引入mian.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> <span class="token string">'./components'</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token comment">/* eslint-disable no-new */</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;App/&gt;'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="router模块自动导入"><a href="#router模块自动导入" class="header-anchor">#</a> router模块自动导入</h3> <p>项目结构：</p> <p>router              // 路由文件夹</p> <p>|__index.js          // 路由组织器：用来初始化路由等等</p> <p>|__common.js          // 通用路由：声明通用路由</p> <p>|__modules           // 业务逻辑模块：所以的业务逻辑模块</p> <p>​    |__index.js       // 自动化处理文件：自动引入路由的核心文件</p> <p>​    |__text1.js        // 业务模块text1</p> <p>​    |__text2.js         // 业务模块text2</p> <h4 id="a-modules模块"><a href="#a-modules模块" class="header-anchor">#</a> A.modules模块</h4> <p>index.js内容：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> files <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [&quot;./index.js&quot;, &quot;./text1.js&quot;, &quot;./text2.js&quot;] 返回一个数组</span>
<span class="token keyword">let</span> configRouters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">// /**</span>
<span class="token comment">// * inject routers</span>
<span class="token comment">// */</span>
files<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key </span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// 去除index.js这项</span>
	<span class="token keyword">if</span><span class="token function"> </span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'./index.js'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
	<span class="token comment">// 拼接成一个数组</span>
	configRouters <span class="token operator">=</span> configRouters<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">files</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">)</span> <span class="token comment">// 读取出文件中的default模块</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> configRouters <span class="token comment">// 抛出一个Vue-router期待的结构的数组</span>
</code></pre></div><p>业务text1.js和text2.js内容：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
	 <span class="token punctuation">{</span>
	   path<span class="token operator">:</span> <span class="token string">'/text1'</span><span class="token punctuation">,</span>
	   name<span class="token operator">:</span> <span class="token string">'text1'</span><span class="token punctuation">,</span>
	<span class="token function-variable function">   component</span><span class="token operator">:</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../../views/Text1.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	   desc<span class="token operator">:</span> <span class="token string">'测试1'</span>
	 <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h4 id="b-common-js"><a href="#b-common-js" class="header-anchor">#</a> B.common.js</h4> <p>common路由处理 我们的项目中有一大堆的公共路由需要处理比如404，503等等路由我们都在common.js中进行处理。</p> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
	  <span class="token comment">// 默认页面</span>
	  <span class="token punctuation">{</span>
	    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
	    redirect<span class="token operator">:</span> <span class="token string">'/text1'</span><span class="token punctuation">,</span>
	    hidden<span class="token operator">:</span><span class="token boolean">true</span>
	  <span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token comment">// 无权限页面</span>
	  <span class="token comment">// {</span>
	  <span class="token comment">//   path: '/nopermission',</span>
	  <span class="token comment">//   name: 'nopermission',</span>
	  <span class="token comment">//   component: () =&gt; import('@/views/NoPermission')</span>
	  <span class="token comment">// },</span>
	  <span class="token comment">// // 404</span>
	  <span class="token comment">// {</span>
	  <span class="token comment">//   path: '*',</span>
	  <span class="token comment">//   name: 'lost',</span>
	  <span class="token comment">//   component: () =&gt; import('@/views/404')</span>
	  <span class="token comment">// }</span>
	<span class="token punctuation">]</span>
</code></pre></div><h4 id="c-index-js"><a href="#c-index-js" class="header-anchor">#</a> C.index.js</h4> <p>初始化我们的项目路由</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> RouterConfig <span class="token keyword">from</span> <span class="token string">'./modules'</span> <span class="token comment">// 引入业务逻辑模块</span>
<span class="token keyword">import</span> CommonRouters <span class="token keyword">from</span> <span class="token string">'./common'</span> <span class="token comment">// 引入通用模块</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	 <span class="token comment">// mode: 'history',// 需要服务端支持</span>
	<span class="token function-variable function"> scrollBehavior</span><span class="token operator">:</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">{</span> y<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	 routes<span class="token operator">:</span> RouterConfig<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>CommonRouters<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="插槽-slot"><a href="#插槽-slot" class="header-anchor">#</a> 插槽-slot</h2> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <h2 id="watch-侦听器"><a href="#watch-侦听器" class="header-anchor">#</a> Watch——侦听器</h2> <h3 id="基础用法"><a href="#基础用法" class="header-anchor">#</a> 基础用法</h3> <p>比如一个列表页，我们希望用户在搜索框输入搜索关键字的时候，可以自动触发搜索,此时除了监听搜索框的<code>change</code>事件之外，我们也可以通过<code>watch</code>监听搜索关键字的变化</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!--此处示例使用了element-ui--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>搜索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchValue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--列表，代码省略--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      searchValue<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在值发生变化之后，重新加载数据</span>
    <span class="token function">searchValue</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 判断搜索</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue <span class="token operator">!==</span> oldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$_loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">$_loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 重新加载数据，此处需要通过函数防抖</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="立即触发"><a href="#立即触发" class="header-anchor">#</a> 立即触发</h3> <p>通过上面的代码，现在已经可以在值发生变化的时候触发加载数据了，但是如果要在页面初始化时候加载数据，我们还需要在<code>created</code>或者<code>mounted</code>生命周期钩子里面再次调用<code>$_loadData</code>方法。不过，现在可以不用这样写了，通过配置<code>watch</code>的立即触发属性，就可以满足需求了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 改造watch</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在值发生变化之后，重新加载数据</span>
    searchValue<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过handler来监听属性变化, 初次调用 newValue为&quot;&quot;空字符串， oldValue为 undefined</span>
      <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue <span class="token operator">!==</span> oldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$_loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 配置立即执行属性</span>
      immediate<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="深度监听"><a href="#深度监听" class="header-anchor">#</a> 深度监听</h3> <p>一个表单页面，需求希望用户在修改表单的任意一项之后，表单页面就需要变更为被修改状态。如果按照上例中<code>watch</code>的写法，那么我们就需要去监听表单每一个属性，太麻烦了，这时候就需要用到<code>watch</code>的深度监听<code>deep</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      formData<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        sex<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        deptId<span class="token operator">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在值发生变化之后，重新加载数据</span>
    formData<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 需要注意，因为对象引用的原因， newValue和oldValue的值一直相等</span>
      <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 在这里标记页面编辑状态</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 通过指定deep属性为true, watch会监听对象里面每一个值的变化</span>
      deep<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="随时监听-随时取消-了解一下-watch"><a href="#随时监听-随时取消-了解一下-watch" class="header-anchor">#</a> 随时监听，随时取消，了解一下<code>$watch</code></h3> <p>有这样一个需求，有一个表单，在编辑的时候需要监听表单的变化，如果发生变化则保存按钮启用，否则保存按钮禁用。这时候对于新增表单来说，可以直接通过<code>watch</code>去监听表单数据(假设是<code>formData</code>),如上例所述，但对于编辑表单来说，表单需要回填数据，这时候会修改<code>formData</code>的值，会触发<code>watch</code>,无法准确的判断是否启用保存按钮。现在你就需要了解一下`$watch</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      formData<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$_loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 模拟异步请求数据</span>
    <span class="token function">$_loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 先赋值</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>formData <span class="token operator">=</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'子君'</span><span class="token punctuation">,</span>
          age<span class="token operator">:</span> <span class="token number">18</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 等表单数据回填之后，监听数据是否发生变化</span>
        <span class="token keyword">const</span> unwatch <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>
          <span class="token string">'formData'</span><span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据发生了变化'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            deep<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        <span class="token comment">// 模拟数据发生了变化</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>formData<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'张三'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>根据上例可以看到，我们可以在需要的时候通过<code>this.$watch</code>来监听数据变化。那么如何取消监听呢，上例中<code>this.$watch</code>返回了一个值<code>unwatch</code>,是一个函数，在需要取消的时候，执行 <code>unwatch()</code>即可取消</p> <h2 id="functional-函数式组件"><a href="#functional-函数式组件" class="header-anchor">#</a> functional——函数式组件</h2> <p>什么是函数式组件？可以理解为没有内部状态，没有生命周期钩子函数，没有<code>this</code>(不需要实例化的组件)。</p> <p>在日常写bug的过程中，经常会开发一些纯展示性的业务组件，比如一些详情页面，列表界面等，它们有一个共同的特点是只需要将外部传入的数据进行展现，不需要有内部状态，不需要在生命周期钩子函数里面做处理，这时候你就可以考虑使用函数式组件。</p> <h3 id="函数式组件的代码"><a href="#函数式组件的代码" class="header-anchor">#</a> 函数式组件的代码</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过配置functional属性指定组件为函数式组件</span>
  functional<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 组件接收的外部属性</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    avatar<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 渲染函数
   * @param {*} h
   * @param {*} context 函数式组件没有this, props, slots等都在context上面挂着
   */</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> context
    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>avatar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>avatar<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>img<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;default-avatar.png&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>img<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 方式二</span>
</code></pre></div><p>在上例中，我们定义了一个头像组件，如果外部传入头像，则显示传入的头像，否则显示默认头像。上面的代码中大家看到有一个render函数，这个是<code>Vue</code>使用<code>JSX</code>的写法。</p> <h4 id="为什么使用函数式组件"><a href="#为什么使用函数式组件" class="header-anchor">#</a> 为什么使用函数式组件</h4> <ol><li>最主要最关键的原因是函数式组件不需要实例化，无状态，没有生命周期，所以渲染性能要好于普通组件</li> <li>函数式组件结构比较简单，代码结构更清晰</li></ol> <h4 id="函数式组件与普通组件的区别"><a href="#函数式组件与普通组件的区别" class="header-anchor">#</a> 函数式组件与普通组件的区别</h4> <ol><li>函数式组件需要在声明组件时指定functional</li> <li>函数式组件不需要实例化，所以没有<code>this</code>,<code>this</code>通过<code>render</code>函数的第二个参数来代替</li> <li>函数式组件没有生命周期钩子函数，不能使用计算属性，watch等等</li> <li>函数式组件不能通过$emit对外暴露事件，调用事件只能通过<code>context.listeners.click</code>的方式调用外部传入的事件</li> <li>因为函数式组件是没有实例化的，所以在外部通过<code>ref</code>去引用组件时，实际引用的是<code>HTMLElement</code></li> <li>函数式组件的<code>props</code>可以不用显示声明，所以没有在<code>props</code>里面声明的属性都会被自动隐式解析为<code>prop</code>,而普通组件所有未声明的属性都被解析到<code>$attrs</code>里面，并自动挂载到组件根元素上面(可以通过<code>inheritAttrs</code>属性禁止)</li></ol> <h4 id="不想用jsx-能用函数式组件吗"><a href="#不想用jsx-能用函数式组件吗" class="header-anchor">#</a> 不想用<code>JSX</code>，能用函数式组件吗？</h4> <p>在<code>Vue2.5</code>之前，使用函数式组件只能通过<code>JSX</code>的方式，在之后，可以通过模板语法来生命函数式组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code>// 方式二
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">functional</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>customShowData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in props.option<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;nbsp;">&amp;nbsp;</span>:<span class="token entity named-entity" title="&amp;nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>two<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{item.value}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'custom-show-data'</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.customShowData</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> SourceHanSansCN-Normal<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> Normal<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 1.3vh<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #FFF<span class="token selector">;
  .one</span> <span class="token punctuation">{</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 0.8vw<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.two</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #ffb300<span class="token punctuation">;</span>
    <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'DIN'</span><span class="token punctuation">,</span><span class="token string">'Helvetica Neue'</span><span class="token punctuation">,</span> Serif<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="computed-计算属性"><a href="#computed-计算属性" class="header-anchor">#</a> computed——计算属性</h2> <ul><li>模板中放入太多的逻辑会让模板过重且难以维护     使用计算属性可以让模板更加的简洁（插值表达式逻辑太复杂）</li> <li><strong>计算属性是基于它们的响应式依赖进行缓存的</strong>，methods也能实现同样效果，但是性能会差点</li></ul> <h3 id="基本用法"><a href="#基本用法" class="header-anchor">#</a> 基本用法</h3> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token function">reversedMessage</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment">// 默认使用了getter属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token comment">//需要把结果return出来</span>
<span class="token comment">//模板使用</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span>reversedMessage<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="get和set"><a href="#get和set" class="header-anchor">#</a> get和set</h3> <p>一般情况下，<strong>我们只是使用了computer中的gettter属性，默认只有 getter，我们只是单纯的使用了gettter属性</strong>，只有当computed监测的值变化的时候，也就是我下面例子中的fullName变化的时候，set才回被调用。</p> <ul><li>get是基于其他的数据来获取到computed里定义的那个数据</li> <li>set是根据computed里定义的那个数据来改变其他的数据</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>vue5 全选<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>allcheck<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>全选<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in datalist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-</span> <span class="token attr-name">model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.status<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>{{item.xueli}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>批量操作<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> datalist<span class="token operator">=</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>xueli<span class="token operator">:</span><span class="token string">'小学'</span><span class="token punctuation">,</span>status<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>xueli<span class="token operator">:</span><span class="token string">'初中'</span><span class="token punctuation">,</span>status<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>xueli<span class="token operator">:</span><span class="token string">'高中'</span><span class="token punctuation">,</span>status<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span>xueli<span class="token operator">:</span><span class="token string">'大学'</span><span class="token punctuation">,</span>status<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> vm<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token operator">:</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span><span class="token punctuation">{</span>        
            
              datalist<span class="token operator">:</span>datalist
           
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        computed<span class="token operator">:</span><span class="token punctuation">{</span>
            allcheck<span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            	<span class="token keyword">var</span> newarr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
              newarr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>datalist<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token operator">!</span>item<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
             <span class="token punctuation">}</span><span class="token punctuation">)</span>
             <span class="token keyword">if</span><span class="token punctuation">(</span>newarr<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
            	<span class="token keyword">this</span><span class="token punctuation">.</span>datalist<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>status<span class="token operator">=</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="filter-过滤器"><a href="#filter-过滤器" class="header-anchor">#</a> filter—— 过滤器</h2> <p>格式化数据，比如将字符串格式化为首字母大写，将日期格式化为指定的格式等。</p> <p>过滤器不改变真正的data，而只是改变渲染的结果，并返回过滤后的版本。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 全局</span>
<span class="token comment">//value就是要处理的数据</span>
Vue<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>‘过滤器名称’<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 过滤器业务逻辑</span>
	<span class="token keyword">return</span>   js逻辑处理结果
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 使用</span>
<span class="token comment">// 过滤器可以用在：双花括号插值表达式</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>msg <span class="token operator">|</span> upper<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">// 支持级联操作</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>msg <span class="token operator">|</span> upper <span class="token operator">|</span> lower<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">// 过滤器可以用在：绑定属性时候即v-bind表达式。</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span>bind<span class="token operator">:</span>id<span class="token operator">=</span>“id <span class="token operator">|</span> formatId&quot;<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 


<span class="token comment">// 局部</span>
filters<span class="token operator">:</span> <span class="token punctuation">{</span> 
  <span class="token function-variable function">capitalize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span>  处理结果
	<span class="token punctuation">}</span> 
<span class="token punctuation">}</span> 
</code></pre></div><h2 id="v-自定义指令"><a href="#v-自定义指令" class="header-anchor">#</a> v- ——自定义指令</h2> <p>之前用单列加vue.extend实现过挂载到全局loading</p> <p>element还通过v-loading指令。</p> <ol><li>可以将<code>loading</code>挂载到某一个元素上面。</li> <li>可以使用指令在指定的元素上面挂载<code>loading</code></li></ol> <h3 id="开发v-loading指令"><a href="#开发v-loading指令" class="header-anchor">#</a> 开发<code>v-loading</code>指令</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> LoadingComponent <span class="token keyword">from</span> <span class="token string">'./loading'</span>
<span class="token comment">// 使用 Vue.extend构造组件子类</span>
<span class="token keyword">const</span> LoadingContructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>LoadingComponent<span class="token punctuation">)</span>

<span class="token comment">// 定义一个名为loading的指令</span>
Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'loading'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 只调用一次，在指令第一次绑定到元素时调用，可以在这里做一些初始化的设置
   * @param {*} el 指令要绑定的元素
   * @param {*} binding 指令传入的信息，包括 {name:'指令名称', value: '指令绑定的值',arg: '指令参数 v-bind:text 对应 text'}
   */</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoadingContructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      el<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    el<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
    el<span class="token punctuation">.</span>instance <span class="token operator">=</span> instance
    Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      el<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 所在组件的 VNode 更新时调用
   * @param {*} el
   * @param {*} binding
   */</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过对比值的变化判断loading是否显示</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>binding<span class="token punctuation">.</span>oldValue <span class="token operator">!==</span> binding<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      el<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 只调用一次，在 指令与元素解绑时调用
   * @param {*} el
   */</span>
  <span class="token function">unbind</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mask <span class="token operator">=</span> el<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>$el
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mask<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      mask<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>mask<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    el<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="在元素上面使用指令"><a href="#在元素上面使用指令" class="header-anchor">#</a> 在元素上面使用指令</h3> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visible<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      visible<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="项目中哪些场景可以自定义指令"><a href="#项目中哪些场景可以自定义指令" class="header-anchor">#</a> 项目中哪些场景可以自定义指令</h3> <ol><li>为组件添加<code>loading</code>效果</li> <li>按钮级别权限控制 <code>v-permission</code></li> <li>代码埋点,根据操作类型定义指令</li> <li>input输入框自动获取焦点</li> <li>其他等等。。。</li></ol> <h2 id="vue-observable-实现状态管理"><a href="#vue-observable-实现状态管理" class="header-anchor">#</a> Vue.observable——实现状态管理</h2> <p>小型项目进行各组件传值，可以使用该api</p> <h3 id="创建-store"><a href="#创建-store" class="header-anchor">#</a> 创建 <code>store</code></h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 通过Vue.observable创建一个可响应的对象</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  userInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  roleIds<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 定义 mutations, 修改属性</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token parameter">userInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfo
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setRoleIds</span><span class="token punctuation">(</span><span class="token parameter">roleIds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>roleIds <span class="token operator">=</span> roleIds
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="在组件中引用"><a href="#在组件中引用" class="header-anchor">#</a> 在组件中引用</h3> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    {{ userInfo.name }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> store<span class="token punctuation">,</span> mutations <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../store'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>userInfo
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mutations<span class="token punctuation">.</span><span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'子君'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="render函数-不懂"><a href="#render函数-不懂" class="header-anchor">#</a> render函数 不懂</h2> <h2 id="自定义生命周期函数"><a href="#自定义生命周期函数" class="header-anchor">#</a> 自定义生命周期函数</h2> <p>当你使用<code>Vue</code>的<code>mixins</code>的时候，是否有发现，如果混入的<code>methods</code>里面的方法与组件的方法同名，则会被组件方法覆盖，但是生命周期函数如果重名，混入的与组件自身的都会被执行，且执行顺序是先混入和自身</p> <h3 id="了解vue合并策略"><a href="#了解vue合并策略" class="header-anchor">#</a> 了解<code>Vue</code>合并策略</h3> <p>在Vue中，提供了一个api, Vue.config.optionMergeStrategies,可以通过这个api去自定义选项的合并策略。</p> <h3 id="通过合并策略自定义生命周期函数"><a href="#通过合并策略自定义生命周期函数" class="header-anchor">#</a> 通过合并策略自定义生命周期函数</h3> <p>网页打开过多，页面里面存在定时器，ajax轮询和动画导致卡顿；window提供事件<code>visibilitychange</code>,可以用来判断浏览器页签是否显示。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$_hanldeVisiblityChange<span class="token punctuation">)</span>
    <span class="token comment">// 此处用了hookEvent，可以参考小编前一篇文章</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'hook:beforeDestroy'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>
        <span class="token string">'visibilitychange'</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$_hanldeVisiblityChange
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">$_hanldeVisiblityChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">'hidden'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 停掉那一堆东西</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">'visible'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 开启那一堆东西</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过上面的代码，可以看到在每一个需要监听处理的文件都要写一堆事件监听，判断页面是否显示的代码，一处两处还可以，文件多了就头疼了，这时候小编突发奇想，定义一个页面显示隐藏的生命周期钩子,把这些判断都封装起来</p> <h3 id="自定义生命周期钩子函数"><a href="#自定义生命周期钩子函数" class="header-anchor">#</a> 自定义生命周期钩子函数</h3> <p>定义生命周期函数 <code>pageHidden</code> 与 <code>pageVisible</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 通知所有组件页面状态发生了变化</span>
<span class="token keyword">const</span> <span class="token function-variable function">notifyVisibilityChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">lifeCycleName<span class="token punctuation">,</span> vm</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 生命周期函数会存在$options中，通过$options[lifeCycleName]获取生命周期</span>
  <span class="token keyword">const</span> lifeCycles <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">[</span>lifeCycleName<span class="token punctuation">]</span>
  <span class="token comment">// 因为使用了created的合并策略，所以是一个数组</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lifeCycles <span class="token operator">&amp;&amp;</span> lifeCycles<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 遍历 lifeCycleName对应的生命周期函数列表，依次执行</span>
    lifeCycles<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">lifecycle</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">lifecycle</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 遍历所有的子组件，然后依次递归执行</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$children <span class="token operator">&amp;&amp;</span> vm<span class="token punctuation">.</span>$children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">notifyVisibilityChange</span><span class="token punctuation">(</span>lifeCycleName<span class="token punctuation">,</span> child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 添加生命周期钩子函数
 * @param {*} rootVm vue 根实例，在页面显示隐藏时候，通过root向下通知
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> optionMergeStrategies <span class="token operator">=</span> Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>optionMergeStrategies
  <span class="token comment">/*
    定义了两个生命周期函数 pageVisible, pageHidden
    为什么要赋值为 optionMergeStrategies.created呢
    这个相当于指定 pageVisible, pageHidden 的合并策略与 created的相同（其他生命周期函数都一样）
   */</span>
  optionMergeStrategies<span class="token punctuation">.</span>pageVisible <span class="token operator">=</span> optionMergeStrategies<span class="token punctuation">.</span>beforeCreate
  optionMergeStrategies<span class="token punctuation">.</span>pageHidden <span class="token operator">=</span> optionMergeStrategies<span class="token punctuation">.</span>created
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 将事件变化绑定到根节点上面
 * @param {*} rootVm
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">rootVm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断调用哪个生命周期函数</span>
    <span class="token keyword">let</span> lifeCycleName <span class="token operator">=</span> <span class="token keyword">undefined</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">'hidden'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lifeCycleName <span class="token operator">=</span> <span class="token string">'pageHidden'</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">'visible'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lifeCycleName <span class="token operator">=</span> <span class="token string">'pageVisible'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>lifeCycleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 通过所有组件生命周期发生变化了</span>
      <span class="token function">notifyVisibilityChange</span><span class="token punctuation">(</span>lifeCycleName<span class="token punctuation">,</span> rootVm<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="应用"><a href="#应用" class="header-anchor">#</a> 应用</h3> <ol><li><p>在<code>main.js</code>主入口文件引入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> init<span class="token punctuation">,</span> bind <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils/custom-life-cycle'</span>

<span class="token comment">// 初始化生命周期函数, 必须在Vue实例化之前确定合并策略</span>
<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  router<span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

<span class="token comment">// 将rootVm 绑定到生命周期函数监听里面</span>
<span class="token function">bind</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>在需要的地方监听生命周期函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">pageVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'页面显示出来了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">pageHidden</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'页面隐藏了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h2> <p>init&gt;mount&gt;render&gt;vdom&gt;patch&gt;dom</p> <p>渲染子组件的时候又会重新执行上面的这些过程</p> <h3 id="beforecreate和created"><a href="#beforecreate和created" class="header-anchor">#</a> beforeCreate和created</h3> <p>这两个生命周期是vue init的过程,先父后子</p> <h3 id="beforemounted和mounted"><a href="#beforemounted和mounted" class="header-anchor">#</a> beforeMounted和mounted</h3> <p>beforeMounted是在mount的开始执行的时候调用，渲染子组件的时候再执行beforeMounted，所以它的执行顺序，先父后子</p> <p>mounted执行顺序先子后父</p> <h3 id="beforeupdate和updated"><a href="#beforeupdate和updated" class="header-anchor">#</a> beforeUpdate和updated</h3> <p>组件更新的时候，先更新父组件，然后通过传给子组件的props的变化，影响子组件的更新，所以beforeUpdate执行顺序，先父后子</p> <p>所以updated执行顺序先子后父</p> <h3 id="beforedestory和destoryed"><a href="#beforedestory和destoryed" class="header-anchor">#</a> beforeDestory和destoryed</h3> <p>beforeDestory：先父后子，先在父组件开始beforeDestory钩子，然后调用子组件的</p> <p>destoryed执行顺序先子后父</p> <h3 id="activated和deactivated"><a href="#activated和deactivated" class="header-anchor">#</a> activated和deactivated</h3> <p>activated执行顺序先子后父</p> <p>deactivated执行顺序先子后父</p> <table><thead><tr><th><strong>生命周期钩子函数</strong></th> <th><strong>实例处于阶段</strong></th> <th><strong>描述</strong></th> <th><strong>能否获取到el (this.$el)</strong></th> <th><strong>能否获取到data (this.xxx)</strong></th> <th><strong>能否使用methods中的方法 (this.xxx())</strong></th></tr></thead> <tbody><tr><td>beforeCreate</td> <td>创建前</td> <td>实例已初始化，但数据观测，watch/event 事件回调还未配置</td> <td>不能</td> <td>不能</td> <td>不能</td></tr> <tr><td>created</td> <td>创建后</td> <td>已完成如下配置，数据观测 (data observer)，property 和方法的运算，watch/event 事件回调</td> <td>不能</td> <td>能</td> <td>能</td></tr> <tr><td>beforeMount</td> <td>挂载前</td> <td>dom已初始化，但并未挂载和渲染</td> <td>能</td> <td>能</td> <td>能</td></tr> <tr><td>mounted</td> <td>挂载后</td> <td>dom已完成挂载和渲染</td> <td>能</td> <td>能</td> <td>能</td></tr> <tr><td>beforeUpdate</td> <td>更新前</td> <td>数据已改变，但dom未更新</td> <td>能</td> <td>能</td> <td>能</td></tr> <tr><td>updated</td> <td>更新后</td> <td>dom已更新</td> <td>能</td> <td>能</td> <td>能</td></tr> <tr><td>beforeDestroy</td> <td>销毁前</td> <td>实例销毁前，实例仍然可用</td> <td>能</td> <td>能</td> <td>能</td></tr> <tr><td>destroyed</td> <td>销毁后</td> <td>实例已销毁，所有指令被解绑，事件监听器被移除，子实例都被销毁</td> <td>能</td> <td>能</td> <td>能</td></tr></tbody></table> <p>1.执行顺序为:extends&gt;mixins1&gt;mixins2&gt;created(自己的生命周期) 2.选项中数据属性如data,methods,后面执行的回覆盖前面的,而生命周期钩子都会执行</p> <h2 id="hookevent-监听组件生命周期"><a href="#hookevent-监听组件生命周期" class="header-anchor">#</a> hookEvent——监听组件生命周期</h2> <h3 id="_1-内部监听生命周期函数"><a href="#_1-内部监听生命周期函数" class="header-anchor">#</a> 1. 内部监听生命周期函数</h3> <p>echarts</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>echarts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
    <span class="token comment">// 请求数据，赋值数据 等等一系列操作...</span>
    <span class="token comment">// 监听窗口发生变化，resize组件</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$_handleResizeChart<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 干了一堆活</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 干了一堆活</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 组件销毁时，销毁监听事件</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$_handleResizeChart<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">$_handleResizeChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>chart<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 其他一堆方法</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但是现在两段代码分开而且相隔几百行代码，可读性比较差，应该将监听<code>resize</code>事件与销毁<code>resize</code>事件放到一起</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
    <span class="token comment">// 请求数据，赋值数据 等等一系列操作...</span>
    
    <span class="token comment">// 监听窗口发生变化，resize组件</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$_handleResizeChart<span class="token punctuation">)</span>
    <span class="token comment">// 通过hook监听组件销毁钩子函数，并取消监听事件</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$once</span><span class="token punctuation">(</span><span class="token string">'hook:beforeDestroy'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$_handleResizeChart<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">$_handleResizeChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this.chart.resize()</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><em>在<code>Vue</code>组件中，可以用过<code>$on</code>,<code>$once</code>去监听所有的生命周期钩子函数，如监听组件的<code>updated</code>钩子函数可以写成 <code>this.$on('hook:updated', () =&gt; {})</code></em></p></div> <h3 id="_2-外部监听生命周期函数"><a href="#_2-外部监听生命周期函数" class="header-anchor">#</a> 2. 外部监听生命周期函数</h3> <p>用了一个第三方组件，需要监听第三方组件数据的变化，但是组件又没有提供<code>change</code>事件，只能在外部监听组件的<code>updated</code>钩子函数。</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!--通过@hook:updated监听组件的updated生命钩子函数--&gt;</span>
  <span class="token comment">&lt;!--组件的所有生命周期钩子都可以通过@hook:钩子函数名 来监听触发--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-select</span> <span class="token attr-name"><span class="token namespace">@hook:</span>updated</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$_handleSelectUpdated<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> CustomSelect <span class="token keyword">from</span> <span class="token string">'../components/custom-select'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    CustomSelect
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">$_handleSelectUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'custom-select组件的updated钩子函数被触发'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="scope-样式穿透"><a href="#scope-样式穿透" class="header-anchor">#</a> scope——样式穿透</h2> <p>在开发中修改第三方组件样式是很常见，但由于 scoped 属性的样式隔离，可能需要去除 scoped 或是另起一个 style 。这些做法都会带来副作用（组件样式污染、不够优雅），样式穿透在css预处理器中使用才生效。</p> <ul><li><p>less使用  <strong>/deep/</strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">&lt;style scoped lang=&quot;less&quot;&gt;
.content /deep/ .el-button</span> <span class="token punctuation">{</span>
	 <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;/style&gt;
</code></pre></div></li> <li><p>scss使用 <strong>::v-deep</strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">&lt;style scoped lang=&quot;scss&quot;&gt;
.content ::v-deep .el-button</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;/style&gt;
</code></pre></div></li> <li><p>stylus使用 <strong>&gt;&gt;&gt;</strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">&lt;style scoped ang=&quot;stylus&quot;&gt;
外层 &gt;&gt;&gt; .custon-components</span><span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;/style&gt;
</code></pre></div></li></ul> <h2 id="动态组件-页面灵活渲染"><a href="#动态组件-页面灵活渲染" class="header-anchor">#</a> 动态组件——页面灵活渲染</h2> <p>需要根据用户的权限不同，页面上要显示不同的内容;将不同权限对应的组件写了出来，然后再通过<code>v-if</code>来判断要显示哪个组件，就有了下面的代码</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>statistics-dp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--头部--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dp-header</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>测试<span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">@to-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>toModule<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dp-header</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--内容--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentView<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> dpHeader <span class="token keyword">from</span> <span class="token string">'./dp-header'</span>
  <span class="token keyword">import</span> defaultView <span class="token keyword">from</span> <span class="token string">'./module/default-view'</span>
  <span class="token keyword">import</span> deviceView <span class="token keyword">from</span> <span class="token string">'./module/device-view'</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span>
      dpHeader<span class="token punctuation">,</span>
      defaultView<span class="token punctuation">,</span>
      deviceView
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        index<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        componentList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'defaultView'</span><span class="token punctuation">,</span> <span class="token string">'deviceView'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'companyList'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">destroyed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'大屏主体注销了'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    computed<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">currentView</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>componentList<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>componentList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>componentList<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">toModule</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> index
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.statistics-dp</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>circle<span class="token punctuation">,</span> #0074CB -100%<span class="token punctuation">,</span> #000823 60%<span class="token punctuation">)</span><span class="token selector">;
    div,ul,li,span</span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
      <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>roleComponents<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>roleComponent<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> AdminInfo <span class="token keyword">from</span> <span class="token string">'./admin-info'</span>
<span class="token keyword">import</span> BookkeeperInfo <span class="token keyword">from</span> <span class="token string">'./bookkeeper-info'</span>
<span class="token keyword">import</span> HrInfo <span class="token keyword">from</span> <span class="token string">'./hr-info'</span>
<span class="token keyword">import</span> UserInfo <span class="token keyword">from</span> <span class="token string">'./user-info'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    AdminInfo<span class="token punctuation">,</span>
    BookkeeperInfo<span class="token punctuation">,</span>
    HrInfo<span class="token punctuation">,</span>
    UserInfo
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      roleComponents<span class="token operator">:</span> <span class="token punctuation">{</span>
        admin<span class="token operator">:</span> AdminInfo<span class="token punctuation">,</span>
        bookkeeper<span class="token operator">:</span> BookkeeperInfo<span class="token punctuation">,</span>
        hr<span class="token operator">:</span> HrInfo<span class="token punctuation">,</span>
        user<span class="token operator">:</span> UserInfo
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      role<span class="token operator">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
      roleComponent<span class="token operator">:</span> <span class="token keyword">undefined</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> role<span class="token punctuation">,</span> roleComponents <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>roleComponent <span class="token operator">=</span> roleComponents<span class="token punctuation">[</span>role<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="resize-监听事件"><a href="#resize-监听事件" class="header-anchor">#</a> resize——监听事件</h2> <div class="language-vue extra-class"><pre class="language-vue"><code>mounted () {
// 挂载监听
	window.addEventListener('resize', this.calHeight)
// 取消监听
	this.$once('hook:beforeDestroy', () =&gt; {  		  
    window.removeEventListener('resize', this.calHeight)
	})
},
activated () {
  // 切换时候也重新设置大小
	this.$nextTick(() =&gt; {    
		this.calHeight()
	})
},
methods: {
	calHeight () {  
		if (this.$refs.container &amp;&amp; this.$refs.header &amp;&amp; this.$refs.top) {
		this.tableHeight = this.$refs.container.offsetHeight - 		this.$refs.top.offsetHeight - this.$refs.header.offsetHeight - 35 + 'px' }
	}
}
</code></pre></div><h2 id="settime-定时器使用"><a href="#settime-定时器使用" class="header-anchor">#</a> setTime——定时器使用</h2> <h3 id="方式一、挂着到this上"><a href="#方式一、挂着到this上" class="header-anchor">#</a> 方式一、挂着到this上</h3> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getStatus<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ buttonText }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				timer<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">//首先我在data函数里面进行定义定时器名称：</span>
				buttonText <span class="token operator">:</span> <span class="token string">'轮询获取订单支付状态'</span><span class="token punctuation">,</span>
				timerNum<span class="token operator">:</span> <span class="token number">60</span> <span class="token comment">// 设置定时器时间</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动定时器</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  <span class="token comment">//创建定时器</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timerNum <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 设置的定时器时间为0后执行的操作</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭定时器</span>
						window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'码灵导航 - 程序员网址导航'</span><span class="token punctuation">,</span> <span class="token string">'_blank'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在新窗口打开程序员网址导航</span>
					<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 启动定时器</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>timerNum <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 定时器减1</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'获取中('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>timerNum <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clearTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//清除定时器</span>
				<span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 最后在beforeDestroy()生命周期内清除定时器：</span>
		<span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		    <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>        
		    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="方式二、const命名"><a href="#方式二、const命名" class="header-anchor">#</a> 方式二、const命名</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定时器</span>
<span class="token function">setTimeHandle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 执行</span>
	<span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 处理事情</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">)</span>
	<span class="token comment">// 清除</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$once</span><span class="token punctuation">(</span><span class="token string">'hook:beforeDestroy'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'清除定时器'</span><span class="token punctuation">)</span>
		<span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="方式三、请求完成再打开定时器"><a href="#方式三、请求完成再打开定时器" class="header-anchor">#</a> 方式三、请求完成再打开定时器</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 请求</span>
<span class="token function">getAllData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>beltlinedisplay<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         <span class="token comment">// 请求完成调用定时器</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setTimeHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 定时器</span>
      <span class="token function">setTimeHandle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refquency<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
</code></pre></div><h2 id="this-set-obj-key-value-响应式"><a href="#this-set-obj-key-value-响应式" class="header-anchor">#</a> this.$set(obj,key,value)——响应式</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// data</span>
<span class="token punctuation">{</span>
    person<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 个人信息</span>
        name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        gender<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 作为接口参数传递</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span>

<span class="token comment">// 接口获取数据，批量处理</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>data
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'person'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="策略模式"><a href="#策略模式" class="header-anchor">#</a> 策略模式</h2> <p>策略模式的使用，避免过多的if else判断，也可以替代简单逻辑的switch</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">formatDemandItemType</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">'基础'</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">'高级'</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">'VIP'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 策略模式</span>
<span class="token keyword">const</span> <span class="token function-variable function">formatDemandItemType2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'基础'</span><span class="token punctuation">,</span>
        <span class="token number">2</span><span class="token operator">:</span> <span class="token string">'高级'</span><span class="token punctuation">,</span>
        <span class="token number">3</span><span class="token operator">:</span> <span class="token string">'VIP'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> obj<span class="token punctuation">[</span>value<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="职责单一"><a href="#职责单一" class="header-anchor">#</a> 职责单一</h2> <p>任何时候尽量是的一个函数就做一件事情，而不是将各种逻辑全部耦合在一起，提高单个函数的复用性和可读性
每个页面都会在加载完成时进行数据的请求并展示到页面</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将全部的请求行为聚合在init函数中</span>
  <span class="token comment">// 将每个请求单独拆分</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getList1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getList2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">getList1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// to do ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">getList2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// to do ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="冻结渲染无关的数据"><a href="#冻结渲染无关的数据" class="header-anchor">#</a> 冻结渲染无关的数据</h2> <p>vue中data的数据默认便会进行双向数据绑定，若是将大量的和渲染无关的数据直接放置在data中，将会浪费双向数据绑定时所消耗的性能，将这些和渲染无关的数据进行抽离并配合Object.freeze进行处理
table中columns数据可以单独提取一个外部js文件作为配置文件，也可以在当前.vue文件中定义一个常量定义columns数据，因为无论如何都是固定且不会修改的数据，应该使用Object.freeze进行包裹，既可以提高性能还可以将固定的数据抽离，一些下拉框前端固定的数据也建议此操作</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> columnList <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> align<span class="token operator">:</span> <span class="token string">'center'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">'性别'</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token string">'gender'</span><span class="token punctuation">,</span> align<span class="token operator">:</span> <span class="token string">'center'</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>需要注意的是 Object.freeze() 冻结的是值，这时仍然可以将变量的引用替换掉，还有确保数据不会变才可以使用这个语法，如果要对数据进行修改和交互，就不适合使用冻结了。</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/1.风格-vue2.0.html" class="prev">
        风格指南
      </a></span> <span class="next"><a href="/vue/3.组件-vue2.0.html">
        组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e2f3dc93.js" defer></script><script src="/assets/js/2.a230187c.js" defer></script><script src="/assets/js/29.8970969c.js" defer></script>
  </body>
</html>
